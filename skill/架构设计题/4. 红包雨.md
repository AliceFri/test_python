###  1. 红包redis设计

    红包列表

    用户红包 哈希表

    事务原子性： 事务模式/ Lua脚本

### 2. 事务原理

    MULTI           标记一个事务块的开始
    EXEC            执行所有事务块内的命令
    DISCARD         放弃执行事务块内的所有命令

    WATCH key       监视key,如果事务执行之前这个key被其他命令所改动，那么事务将被打断
    UNWATCH         取消watch命令 对所有 key 的监视

    watch 命令可以实现类似乐观锁的效果 。

### 3. 事务的ACID

    A（原子性）：  命令入队时报错， 会放弃事务执行，保证原子性；命令入队时正常，执行 EXEC 命令后报错，不保证原子性；

    C（一致性）：

    I（隔离性）：     exec命令执行前， 并不保证隔离性，watch机制实现乐观锁的效果；
                    exec命令执行后， 单线程，保证事务的隔离性