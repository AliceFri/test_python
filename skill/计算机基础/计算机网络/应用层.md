

### 1. 应用框架

    C/S

    P2P

-----------------
### 2. Web 和 Http协议

    URL：    协议名://域名：端口         https默认443端口， http默认8080端口

    HTTP:   超文本传输协议 （使用TCP）     无状态协议（优点简单方便，缺点需要其他方式维护连接信息）
            http1.0     短连接， 一次连接进行一次http请求就关闭
            http1.1     默认长连接， 一次连接依次进行多次http请求
            http2       多路复用， 一次连接可同时进行多次http请求

    应用层得自己进行message长度的管理，tcp不做这个

    Session 与 Cookies
        session保存在服务端， cookie保存在客户端， cookie一般为session id

    JWT—Token
        减少服务器的负担，header.payload.sign. 安全性主要由sign 签名提供（HS256算法， RS256算法）    
        base64编码

    反向代理 与 正向代理
        正向代理： 翻墙，
        反向代理： nginx转发， CDN， 负载均衡等， 客户不知道访问的服务具体在那里

    强制缓存 与 协商缓存
        强制缓存： 适用于不经常改变的大文件
        协商缓存： 通过 ETag 与 md5 技术。
    

-----------------
### 3. FTP

    向远程主机上传输文件/从远程主机上下载文件

    C/S 模式

    port: 21(控制连接)/20(数据连接)

    FTP 服务器维护用户的状态信息， 当前路径， 用户账户与控制连接信息。

-----------------
### 4. EMail

    SMTP 协议

    组成：
        用户代理 + 邮件服务器 + SMTP协议

        用户代理： 又名邮件阅读器， 如 Outlook Foxmail. 输出和输入邮件

        邮件服务器： 邮箱中管理和维护发送给用户的邮件，输出报文队列保持待发送邮件报文

        SMTP协议： 发送方邮件服务器 <--> 接受端邮件服务器

    端口号 25
    
    传输的3个阶段
        1. 握手
        2. 发送邮件
        3. 关闭
    
    邮件发送协议:
        SMTP：
            1. 持久连接
            2. ASCII编写
            3. 使用CRLF作为尾部

            MIME版本： 多媒体扩展 （Base64编码/解码， 达到使用ASCII码传递的作用）

    邮件访问协议：
        POP3     用户身份确认/下载邮件
        IMAP    ......
        HTTP    方便

    发送方用户代理 --（SMTP） 邮件服务器 --（SMTP） 邮件服务器 --（pop3|IMAP|HTTP） 接受方用户代理

--------------

### 5. DNS

    作用：
    1. 负责 ip 和 域名的解析工作
    2. 别名 到规范名字的 转换
    3. 负载均衡

    分层的， 基于域的命名机制
    运行在 UDP 53 号端口， 只需要一次来回， 不需要握手

    根服务器 --> 二级域名服务器 --> 三级域名服务器

    DNS 缓存： 一般为 2 天
    
    DNS 类型：     A记录： 域名： ip
                  CNAME记录： 别名： 规范名
                  NS记录 ：   域名： 该域名的权威DNS服务器的域名
                  MX记录：    域名： 对应的邮件服务器的名字
    
    
    1. 浏览器 DNS 缓存
    2. 操作系统 DNS 缓存
    3. host
    4. resolver(应用调用，本机上的服务， 向name server 发出查询报文)
    5. local name server （默认名字服务器）
    6. 层次结构 name server.    (迭代查询)
    
    新增一个域：
        1. 上级域 DNS服务器 增加两条记录： 1. 子域名： ip 2. 子域名 Dns服务器
        com TLD服务器 两条记录
        network.com, dns1.network.com, NS
        dns1.network.com, 212.122.212.1, A
         
        2. 在 network.com的 权威服务器212.122.212.1
        确保有
        用于web服务的 www.network.com 的类型为A的记录
        用于邮件服务器 mail.network.com 的类型为MX的记录

    DNS攻击手段：
        DDos 攻击： 流量轰炸：发送大量ping
            流量过滤器， 防火墙， Local Name Server 缓存，不用查询根服务器
        大量查询：
            大部分DNS缓存了TLD
        重定向攻击：
            比较困难，因为是分布式
        利用DNS基础设施 进行DDos
            查询放大： 响应报文比查询报文大



--------------

### 7. CDN

    视频流量： 占据着互联网大部分的宽带

    解决方案： 分布式，应用层面的基础设施
    
    压缩视频：   1，空间冗余。 2. 时间冗余

    存储视频的流化服务：
        1. 边看边下
        DASH：   服务器将视频分割成多个块， 每个块独立存储，编码于不同码率。告示文件，提供不同块的URL
                客户端先获取告示文件，根据需求与带宽请求时间点不同的视频块，不同清晰度的视频块  

    CDN：（内容分发网络）
        挑战： 单点故障， 周围网络拥堵， 网络跳数多不能解决

        CDN的运营商：
            全网部署缓存节点， 存储服务内容，就近为用户提供服务， 提高用户体验
            1. ENTER DEEP， 深入到接入网， 与用户近， 缺点， 节点多
            2. BRING HOME.  部署在关键位置， 与用户相对近， 节点较少
        
            用户怎么重定向到最近的拷贝，请求内容
                1. 用户从源服务器获取到 告示文件， 根据告示文件选择最近的ip
                2. 域名重定向 通过DNS服务
                    普通域名： 域名对应的ip地址
                    CDN域名：  先通过DNS查到CName(另一个域名（CDN专用的DNS域名服务器）) 再查到IP（可以是负载均衡器的ip）
                    
                    CDN的例子很好，事实上CNAME(域名解析到另一个域名)一个很重要的用处就是委托解析。                    

                    CDN专用的DNS域名服务器（CDN运营商提供的），是为了调度离用户最近的服务器

                    使用 CDN 服务的网站，只需要将域名解析权交给 CDN 服务商，接着将需要分发的内容上传到 CDN
                    
        
            PUSH(源服务器主动推到CDN， 刷新预热) / 
            POP 第一次请求CDN， 会去源服务器获取（未命中Cache, 回源）
            
        接入CDN ，需要防止DDOS 攻击
